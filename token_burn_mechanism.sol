// Bugfix: incorrect reward calculation
// Improve contract state management
// Optimize contract upgrade process
